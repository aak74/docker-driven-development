# Тестирование с использованием БД

В предыдущем [примере](../ex11/) мы подключили БД. И даже заполнили ее. Но при перезапуске контейнера все данные потерялись. Такое поведение было описано в [нулевом примере](../ex0/).

Такое неожиданное поведение можно использовать себе на пользу.
Мне представляются два сценария использования и оба связаны с тестированием:
1. Автоматическое тестирование.
1. Тестирование миграций.
1. Ручное тестирование.

Все кто пишет unit тесты знает, что __запуск тестов с использованием БД очень дорогой__. Такие тесты выполняются очень долго. Идеальный вариант написание mock-ов, но к сожалению это не всегда возможно или целесообразно.

## Стандартный подход
Нужно произвести ряд операций: 
1. Создать БД и наполнить БД нужными данными, либо восстановить ее из бэкапа.
1. Выполнить тесты.
1. Удалить или очистить БД.
Восстановление БД обычно занимает минуты. Для запуска unit-тестов это бесконечно долго.
Все три шага нужно выполнять для каждого запуска тестов. Первый шаг очень длительный.

::: tip Известный факт
Чем дольше тест выполняется,тем реже он запускается. 
:::
Подходит для длительного ручного тестирования.

## Современый подход
В случае использования контейнера __минуты превращаются в секунды__.

Один раз создаем образ с восстанавленной из бэкапа БД. Эта операция может быть долгой. Но спасает то, что это нужно сделать единожды. Причем это можно сделать единожды для всех разработчиков.

Для запуска тестов нужно всего три шага:
1. Запускаем контейнер.
1. Запускаем тесты.
1. Останавливаем контейнер.
Все три шага достаточно быстрые.
Подходит для любого вида тестирования.
